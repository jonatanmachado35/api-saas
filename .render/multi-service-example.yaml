# Render Blueprint - Multi-Service Configuration
# Gerencia 3 APIs + 3 Databases em um Ãºnico arquivo

services:
  # ===== API 1: AgentChat =====
  - type: web
    name: agentchat-api
    env: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    plan: free
    region: oregon
    branch: main
    healthCheckPath: /
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
      - key: DATABASE_URL
        fromDatabase:
          name: agentchat-db
          property: connectionString
      - key: JWT_SECRET
        generateValue: true
      - key: GOOGLE_CLIENT_ID
        sync: false
      - key: GOOGLE_CLIENT_SECRET
        sync: false
      - key: CLOUDINARY_CLOUD_NAME
        sync: false
      - key: CLOUDINARY_API_KEY
        sync: false
      - key: CLOUDINARY_API_SECRET
        sync: false
      - key: ABACATEPAY_API_KEY
        sync: false
      - key: CORS_ORIGIN
        sync: false

  # ===== API 2: Sua Segunda API =====
  - type: web
    name: segunda-api
    env: docker
    dockerfilePath: ./apps/segunda-api/Dockerfile
    dockerContext: ./apps/segunda-api
    plan: free
    region: oregon
    branch: main
    healthCheckPath: /health
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 4000
      - key: DATABASE_URL
        fromDatabase:
          name: segunda-db
          property: connectionString
      - key: API_KEY
        generateValue: true

  # ===== API 3: Sua Terceira API =====
  - type: web
    name: terceira-api
    env: docker
    dockerfilePath: ./apps/terceira-api/Dockerfile
    dockerContext: ./apps/terceira-api
    plan: free
    region: oregon
    branch: main
    healthCheckPath: /
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 5000
      - key: DATABASE_URL
        fromDatabase:
          name: terceira-db
          property: connectionString

# ===== Databases =====
databases:
  - name: agentchat-db
    databaseName: agentchat
    user: agentchat
    plan: free
    region: oregon

  - name: segunda-db
    databaseName: segunda
    user: segunda
    plan: free
    region: oregon

  - name: terceira-db
    databaseName: terceira
    user: terceira
    plan: free
    region: oregon
